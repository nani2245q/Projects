<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitZone - Login</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">FitZone</div>
        <div class="nav-links">
            <a href="/">Dashboard</a>
            <a href="/pages/workouts.html">Workouts</a>
            <a href="/pages/exercises.html">Exercises</a>
            <a href="/pages/activity.html">Activity Log</a>
            <span id="user-name"></span>
            <a href="/pages/login.html" id="auth-link" class="active">Login</a>
        </div>
    </nav>

    <div class="auth-container">
        <div id="login-form">
            <h1>Sign In</h1>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="login-email" placeholder="your@email.com">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="login-password" placeholder="Password">
            </div>
            <button class="btn btn-primary" style="width:100%" onclick="doLogin()">Login</button>
            <div class="auth-toggle">Don't have an account? <a href="#" onclick="showRegister()">Register</a></div>
            <div id="login-error" style="color:var(--danger);text-align:center;margin-top:.5rem;font-size:.85rem"></div>
        </div>

        <div id="register-form" style="display:none">
            <h1>Create Account</h1>
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="reg-name" placeholder="Your name">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="reg-email" placeholder="your@email.com">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="reg-password" placeholder="Min 6 characters">
            </div>
            <div class="form-group">
                <label>Fitness Goal</label>
                <select id="reg-goal">
                    <option value="Build muscle">Build muscle</option>
                    <option value="Lose weight">Lose weight</option>
                    <option value="Improve endurance">Improve endurance</option>
                    <option value="General fitness">General fitness</option>
                </select>
            </div>
            <button class="btn btn-primary" style="width:100%" onclick="doRegister()">Register</button>
            <div class="auth-toggle">Already have an account? <a href="#" onclick="showLogin()">Login</a></div>
            <div id="reg-error" style="color:var(--danger);text-align:center;margin-top:.5rem;font-size:.85rem"></div>
        </div>
    </div>

    <script src="/js/config.js"></script>
    <script>
        function showRegister() { document.getElementById('login-form').style.display = 'none'; document.getElementById('register-form').style.display = 'block'; }
        function showLogin() { document.getElementById('login-form').style.display = 'block'; document.getElementById('register-form').style.display = 'none'; }

        async function doLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            try {
                const res = await apiFetch('/api/auth/login', { method: 'POST', body: JSON.stringify({ email, password }) });
                if (res.error) { document.getElementById('login-error').textContent = res.error; return; }
                setAuth(res.token, { id: res.id, name: res.name, email: res.email });
                window.location.href = '/';
            } catch (e) { document.getElementById('login-error').textContent = 'Login failed'; }
        }

        async function doRegister() {
            const data = {
                name: document.getElementById('reg-name').value,
                email: document.getElementById('reg-email').value,
                password: document.getElementById('reg-password').value,
                fitnessGoal: document.getElementById('reg-goal').value
            };
            try {
                const res = await apiFetch('/api/auth/register', { method: 'POST', body: JSON.stringify(data) });
                if (res.error) { document.getElementById('reg-error').textContent = res.error; return; }
                setAuth(res.token, { id: res.id, name: res.name, email: res.email });
                window.location.href = '/';
            } catch (e) { document.getElementById('reg-error').textContent = 'Registration failed'; }
        }
    </script>
</body>
</html>
